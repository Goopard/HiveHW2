+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--+
|                                                                                                           Explain                                                                                                           |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--+
| Plan not optimized by CBO.                                                                                                                                                                                                  |
|                                                                                                                                                                                                                             |
| Vertex dependency in root stage                                                                                                                                                                                             |
| Map 1 <- Map 4 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE)                                                                                                                                                                     |
| Reducer 2 <- Map 1 (SIMPLE_EDGE)                                                                                                                                                                                            |
| Reducer 3 <- Reducer 2 (SIMPLE_EDGE)                                                                                                                                                                                        |
|                                                                                                                                                                                                                             |
| Stage-0                                                                                                                                                                                                                     |
|    Fetch Operator                                                                                                                                                                                                           |
|       limit:-1                                                                                                                                                                                                              |
|       Stage-1                                                                                                                                                                                                               |
|          Reducer 3                                                                                                                                                                                                          |
|          File Output Operator [FS_7091]                                                                                                                                                                                     |
|             compressed:false                                                                                                                                                                                                |
|             Statistics:Num rows: 86854 Data size: 17718247 Basic stats: COMPLETE Column stats: NONE                                                                                                                         |
|             table:{"input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat","serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"}  |
|             Select Operator [SEL_7090]                                                                                                                                                                                      |
|             |  outputColumnNames:["_col0","_col1","_col2"]                                                                                                                                                                  |
|             |  Statistics:Num rows: 86854 Data size: 17718247 Basic stats: COMPLETE Column stats: NONE                                                                                                                      |
|             |<-Reducer 2 [SIMPLE_EDGE]                                                                                                                                                                                      |
|                Reduce Output Operator [RS_7089]                                                                                                                                                                             |
|                   key expressions:_col1 (type: bigint)                                                                                                                                                                      |
|                   Map-reduce partition columns:_col1 (type: bigint)                                                                                                                                                         |
|                   sort order:-                                                                                                                                                                                              |
|                   Statistics:Num rows: 86854 Data size: 17718247 Basic stats: COMPLETE Column stats: NONE                                                                                                                   |
|                   value expressions:_col0 (type: string), _col2 (type: array<string>)                                                                                                                                       |
|                   Filter Operator [FIL_7097]                                                                                                                                                                                |
|                      predicate:(_col1 > 1) (type: boolean)                                                                                                                                                                  |
|                      Statistics:Num rows: 86854 Data size: 17718247 Basic stats: COMPLETE Column stats: NONE                                                                                                                |
|                      Group By Operator [GBY_7086]                                                                                                                                                                           |
|                      |  aggregations:["count(VALUE._col0)","collect_set(VALUE._col1)"]                                                                                                                                      |
|                      |  keys:KEY._col0 (type: string)                                                                                                                                                                       |
|                      |  outputColumnNames:["_col0","_col1","_col2"]                                                                                                                                                         |
|                      |  Statistics:Num rows: 260564 Data size: 53155151 Basic stats: COMPLETE Column stats: NONE                                                                                                            |
|                      |<-Map 1 [SIMPLE_EDGE]                                                                                                                                                                                 |
|                         Reduce Output Operator [RS_7085]                                                                                                                                                                    |
|                            key expressions:_col0 (type: string)                                                                                                                                                             |
|                            Map-reduce partition columns:_col0 (type: string)                                                                                                                                                |
|                            sort order:+                                                                                                                                                                                     |
|                            Statistics:Num rows: 521128 Data size: 106310302 Basic stats: COMPLETE Column stats: NONE                                                                                                        |
|                            value expressions:_col1 (type: bigint), _col2 (type: array<string>)                                                                                                                              |
|                            Group By Operator [GBY_7084]                                                                                                                                                                     |
|                               aggregations:["count()","collect_set(_col39)"]                                                                                                                                                |
|                               keys:_col33 (type: string)                                                                                                                                                                    |
|                               outputColumnNames:["_col0","_col1","_col2"]                                                                                                                                                   |
|                               Statistics:Num rows: 521128 Data size: 106310302 Basic stats: COMPLETE Column stats: NONE                                                                                                     |
|                               Map Join Operator [MAPJOIN_7102]                                                                                                                                                              |
|                               |  condition map:[{"":"Inner Join 0 to 1"}]                                                                                                                                                   |
|                               |  HybridGraceHashJoin:true                                                                                                                                                                   |
|                               |  keys:{"Map 1":"_col16 (type: string)","Map 5":"iata (type: string)"}                                                                                                                       |
|                               |  outputColumnNames:["_col33","_col39"]                                                                                                                                                      |
|                               |  Statistics:Num rows: 521128 Data size: 106310302 Basic stats: COMPLETE Column stats: NONE                                                                                                  |
|                               |<-Map 5 [BROADCAST_EDGE]                                                                                                                                                                     |
|                               |  Reduce Output Operator [RS_7080]                                                                                                                                                           |
|                               |     key expressions:iata (type: string)                                                                                                                                                     |
|                               |     Map-reduce partition columns:iata (type: string)                                                                                                                                        |
|                               |     sort order:+                                                                                                                                                                            |
|                               |     Statistics:Num rows: 611 Data size: 122219 Basic stats: COMPLETE Column stats: NONE                                                                                                     |
|                               |     value expressions:city (type: string)                                                                                                                                                   |
|                               |     Filter Operator [FIL_7100]                                                                                                                                                              |
|                               |        predicate:iata is not null (type: boolean)                                                                                                                                           |
|                               |        Statistics:Num rows: 611 Data size: 122219 Basic stats: COMPLETE Column stats: NONE                                                                                                  |
|                               |        TableScan [TS_7071]                                                                                                                                                                  |
|                               |           alias:airports                                                                                                                                                                    |
|                               |           Statistics:Num rows: 1222 Data size: 244438 Basic stats: COMPLETE Column stats: NONE                                                                                              |
|                               |<-Map Join Operator [MAPJOIN_7101]                                                                                                                                                           |
|                                  |  condition map:[{"":"Inner Join 0 to 1"}]                                                                                                                                                |
|                                  |  HybridGraceHashJoin:true                                                                                                                                                                |
|                                  |  keys:{"Map 1":"uniquecarrier (type: string)","Map 4":"uniquecarrier (type: string)"}                                                                                                    |
|                                  |  outputColumnNames:["_col16","_col33"]                                                                                                                                                   |
|                                  |  Statistics:Num rows: 473753 Data size: 96645727 Basic stats: COMPLETE Column stats: NONE                                                                                                |
|                                  |<-Map 4 [BROADCAST_EDGE]                                                                                                                                                                  |
|                                  |  Reduce Output Operator [RS_7075]                                                                                                                                                        |
|                                  |     key expressions:uniquecarrier (type: string)                                                                                                                                         |
|                                  |     Map-reduce partition columns:uniquecarrier (type: string)                                                                                                                            |
|                                  |     sort order:+                                                                                                                                                                         |
|                                  |     Statistics:Num rows: 109 Data size: 21879 Basic stats: COMPLETE Column stats: NONE                                                                                                   |
|                                  |     value expressions:name (type: string)                                                                                                                                                |
|                                  |     Filter Operator [FIL_7099]                                                                                                                                                           |
|                                  |        predicate:uniquecarrier is not null (type: boolean)                                                                                                                               |
|                                  |        Statistics:Num rows: 109 Data size: 21879 Basic stats: COMPLETE Column stats: NONE                                                                                                |
|                                  |        TableScan [TS_7070]                                                                                                                                                               |
|                                  |           alias:carriers                                                                                                                                                                 |
|                                  |           Statistics:Num rows: 218 Data size: 43758 Basic stats: COMPLETE Column stats: NONE                                                                                             |
|                                  |<-Filter Operator [FIL_7098]                                                                                                                                                              |
|                                        predicate:(uniquecarrier is not null and origin is not null and (cancelled = 1)) (type: boolean)                                                                                     |
|                                        Statistics:Num rows: 430685 Data size: 87859750 Basic stats: COMPLETE Column stats: NONE                                                                                             |
|                                        TableScan [TS_7069]                                                                                                                                                                  |
|                                           alias:flights                                                                                                                                                                     |
|                                           Statistics:Num rows: 3445481 Data size: 702878208 Basic stats: COMPLETE Column stats: NONE                                                                                        |
|                                                                                                                                                                                                                             |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--+